{% extends "base_generic.html" %}


{% block content %}

{% if fast and fast.image %}
    <style>
        #fast-main-container {
            background: linear-gradient(to right,rgba(57, 7, 20, 1) 35%, rgba(57, 7, 20, .95) 50%, transparent 100%), url('{{ fast.image }}') no-repeat right center / contain;
        }   
    </style>
{% endif %}

<div id="fast-main-container" class="row w-100 p-3 mx-3 shadow text-light">
    <div class="col-8">
        {% load static %}
        {% if church %}
            <div class="">
            {% if fast %}
                    <div class="p-3">
                        <div class="text-uppercase mb-3">Fast Together</div>
                        <h2 class="fs-1">{{ fast.name }}</h2>
                        <p class="fs-5">{{ fast.start_date }} - {{ fast.end_date }}</p>
                    </div>
                {% if is_participating %}
                    <p >{{ countdown }}!</p>
                    <p>{{ participant_count }} faithful {{ participant_count|pluralize:"is,are" }} fasting with you today!</p>
                    <p>{{ description }} </p>
                    <!-- placeholder for a medium centered button that says learn more -->
                    {% if fast.url %}
                        <a class="btn btn-primary" href="{{ fast.url }}">Learn More &hellip;</a>
                    {% endif %}
                {% else %}
                    <div class="d-flex flex-column flex-lg-row justify-content-start">
                        <div class="p-3 col-12 col-lg-4 mx-lg-3">
                            <p>You have not yet joined {{ fast.name }} along with 
                            {{ participant_count }} other{{ participant_count|pluralize }}.</p>
                            <form action="{% url 'add_fast_to_profile' fast.id %}" method="post">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-light btn-pill rounded-pill">Join Fast</button>
                            </form>
                        </div>
                        <div class="p-3  col-12 col-lg-6 mx-lg-6">
                            <p>{{ description }} </p>
                        </div>
                    </div>
                {% endif %}
                </div>
            {% else %}
                {% if days_until_next %}
                    {% if upcoming_fasts %}
                        <div class="text-uppercase mb-3">{{ current_date|date:"l, F j, Y" }}</div>
                        <h2 class="fs-3">{{ days_until_next }} days until {{ upcoming_fasts.0.name }}.</h2>
                        <div class="d-lg-flex flex-column align-items-center mt-4">
                            {% include 'components/fast_card.html' with fast=upcoming_fasts.0 %}
                            <div class=" " ><a href="{{ upcoming.fasts.fast_url }}">Learn More About This Fast &rAarr;</a></div>
                        </div>
                    {% endif %}
                {% else %}
                    <h2 class="fs-3">There are no more fasts this year.</h2>
                {% endif %}
            {% endif %}
        {% else %}
            <!-- Placeholder for if they don't have a church -->
        {% endif %}
    </div>
</div>

<div class="row w-100 p-3 mx-3 mb-3 rounded-bottom shadow bg-light text-dark">
    <div class="container">   
            <div id="upcoming-fasts">
                <h2 class=" fs-4 text-start py-3 ">Upcoming Fasts</h2>
                <div class="row">
                    {% if upcoming_fasts %}
                        {% for fast in upcoming_fasts %}
                            {% include 'components/fast_card.html' with fast=fast %}
                        {% endfor %}
                    {% else %}
                        <p>No upcoming fasts in {{ church }}.</p>
                    {% endif %}
                </div>
            </div>
    </div>
</div>

{% endblock %}
